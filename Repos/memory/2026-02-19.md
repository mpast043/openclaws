# 2026-02-19

## Session: Validation artifact emitters

Added emitter utilities for v4.5 Step 2/3 acceptance gate validation.

### New file
- `capacity-demo/scripts/emitters.py` — ValidationEmitter class for producing metrics.json and selection.jsonl

### Modified files
- `capacity-demo/scripts/run_gap_tail.py` — added `--emit` flag to output validation artifacts
- `capacity-demo/scripts/run_gap_quantile.py` — added `--emit` flag to output validation artifacts

### Usage
```bash
cd capacity-demo
python scripts/run_gap_tail.py --n 400 --radius 0.30 --seed 42 --emit
python scripts/run_gap_quantile.py --radius 0.35 --seed 42 --emit
```

This produces in `outputs/gap_tail/` or `outputs/gap_quantile/`:
- `metrics.json` — fit_error, eps_fit, overlap_delta_max, k_glue, N_geo, lambda1, lambda_int
- `selection.jsonl` — accessible, selected, ptr per step

### Update: Emitter format verified
Rewrote emitters to match harness expectations exactly:
- `metrics.json` — single JSON object (not array) with required fields
- `selection.jsonl` — lines with accessible, selected, ptr, theta_ptr, committed, truth

Tested against `v45_apply_step2_step3.py` harness — all Step 2 gates PASS with test data.

### Context
External validation harness (v45_apply_step2_step3.py) requested these artifacts to compute:
- Step 2 PASS/FAIL with computed thresholds (fit, gluing, UV, isolation)
- Step 3 selection stats (gap rate, danger count, committed error)
